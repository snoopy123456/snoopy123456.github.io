<!DOCTYPE html>
<html lang="zh-tw">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.7.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="佛系筆記">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="佛系筆記">
<meta property="og:locale" content="zh-tw">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="佛系筆記">

<link rel="canonical" href="http://yoursite.com/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-tw'
  };
</script>

  <title>佛系筆記</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Cambiar a barra de navegación">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">佛系筆記</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Inicio</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archivo</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/03/telegraf建立-windows/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/unnamed.gif">
      <meta itemprop="name" content="緣分到了，文件自然就做好了！">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/08/03/telegraf建立-windows/" class="post-title-link" itemprop="url">telegraf建立-windows</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Publicado el</span>

              <time title="Creado por: 2018-08-03 14:08:00" itemprop="dateCreated datePublished" datetime="2018-08-03T14:08:00+08:00">2018-08-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Editado el</span>
                <time title="Modificado por: 2020-04-01 11:30:25" itemprop="dateModified" datetime="2020-04-01T11:30:25+08:00">2020-04-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="本文章將介紹-telegraf-建立-windows"><a href="#本文章將介紹-telegraf-建立-windows" class="headerlink" title="本文章將介紹 telegraf 建立 ( windows )"></a>本文章將介紹 telegraf 建立 ( windows )</h2><h3 id="1-下載-telegraf-壓縮檔"><a href="#1-下載-telegraf-壓縮檔" class="headerlink" title="1. 下載 telegraf 壓縮檔"></a>1. 下載 telegraf 壓縮檔</h3><h3 id="下載網址：https-github-com-influxdata-telegraf-releases"><a href="#下載網址：https-github-com-influxdata-telegraf-releases" class="headerlink" title="下載網址：https://github.com/influxdata/telegraf/releases"></a>下載網址：<a href="https://github.com/influxdata/telegraf/releases" target="_blank" rel="noopener">https://github.com/influxdata/telegraf/releases</a></h3><h3 id="2-將檔案解壓縮後會有-config-與-exe-檔，放到須監控的機器底下的-D-Service-telegraf-（-若沒有-D-槽，放在系統槽即可"><a href="#2-將檔案解壓縮後會有-config-與-exe-檔，放到須監控的機器底下的-D-Service-telegraf-（-若沒有-D-槽，放在系統槽即可" class="headerlink" title="2. 將檔案解壓縮後會有 config 與 exe 檔，放到須監控的機器底下的 D:\Service\telegraf\（ 若沒有 D 槽，放在系統槽即可 )"></a>2. 將檔案解壓縮後會有 config 與 exe 檔，放到須監控的機器底下的 D:\Service\telegraf\（ 若沒有 D 槽，放在系統槽即可 )</h3><p><img src="images/1.png" alt=" "></p>
<h3 id="3-打開-telegraf-conf-做設定"><a href="#3-打開-telegraf-conf-做設定" class="headerlink" title="3. 打開 telegraf.conf 做設定"></a>3. 打開 telegraf.conf 做設定</h3><h3 id="telegraf-內容：https-snoopy30485-github-io-2018-08-03-telegraf-windows"><a href="#telegraf-內容：https-snoopy30485-github-io-2018-08-03-telegraf-windows" class="headerlink" title="telegraf 內容：https://snoopy30485.github.io/2018/08/03/telegraf-windows/"></a>telegraf 內容：<a href="https://snoopy30485.github.io/2018/08/03/telegraf-windows/" target="_blank" rel="noopener">https://snoopy30485.github.io/2018/08/03/telegraf-windows/</a></h3><h3 id="4-以系統管理員身份開啟-Command-Prompt-cmd-，輸入指令到-telegraf-的路徑下，進行-telegraf-服務安裝並啟動"><a href="#4-以系統管理員身份開啟-Command-Prompt-cmd-，輸入指令到-telegraf-的路徑下，進行-telegraf-服務安裝並啟動" class="headerlink" title="4. 以系統管理員身份開啟 Command Prompt ( cmd )，輸入指令到 telegraf 的路徑下，進行 telegraf 服務安裝並啟動"></a>4. 以系統管理員身份開啟 Command Prompt ( cmd )，輸入指令到 telegraf 的路徑下，進行 telegraf 服務安裝並啟動</h3><p><img src="images/2.png" alt=" "></p>
<h3 id="進入-telegraf-的路徑下"><a href="#進入-telegraf-的路徑下" class="headerlink" title="進入 telegraf 的路徑下"></a>進入 telegraf 的路徑下</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">D:</span><br><span class="line">cd Service/telegraf</span><br></pre></td></tr></table></figure>
<h3 id="安裝成服務"><a href="#安裝成服務" class="headerlink" title="安裝成服務"></a>安裝成服務</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telegraf.exe --config D:\Service\telegraf\telegraf.conf --service install</span><br></pre></td></tr></table></figure>
<h3 id="啟動也可以到-services-msc-啟動"><a href="#啟動也可以到-services-msc-啟動" class="headerlink" title="啟動也可以到 services.msc 啟動"></a>啟動也可以到 services.msc 啟動</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net start telegraf</span><br></pre></td></tr></table></figure>
<p><img src="images/3.png" alt=" "><br><img src="images/4.png" alt=" "></p>
<h3 id="服務安裝完成後，會在路徑底下多一個剛剛-config-設定的-telegraf-log-檔案"><a href="#服務安裝完成後，會在路徑底下多一個剛剛-config-設定的-telegraf-log-檔案" class="headerlink" title="服務安裝完成後，會在路徑底下多一個剛剛 config 設定的 telegraf.log 檔案"></a>服務安裝完成後，會在路徑底下多一個剛剛 config 設定的 telegraf.log 檔案</h3><p><img src="images/5.png" alt=" "></p>
<h3 id="恭喜-telegraf-建立完成！"><a href="#恭喜-telegraf-建立完成！" class="headerlink" title="恭喜 telegraf 建立完成！"></a>恭喜 telegraf 建立完成！</h3>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/02/grafana開啟google第三方登入驗證/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/unnamed.gif">
      <meta itemprop="name" content="緣分到了，文件自然就做好了！">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/08/02/grafana開啟google第三方登入驗證/" class="post-title-link" itemprop="url">grafana開啟google第三方登入驗證</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Publicado el</span>

              <time title="Creado por: 2018-08-02 17:59:39" itemprop="dateCreated datePublished" datetime="2018-08-02T17:59:39+08:00">2018-08-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Editado el</span>
                <time title="Modificado por: 2020-04-01 11:30:25" itemprop="dateModified" datetime="2020-04-01T11:30:25+08:00">2020-04-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="本文章將介紹使用-GCP-開啟第三方登入驗證"><a href="#本文章將介紹使用-GCP-開啟第三方登入驗證" class="headerlink" title="本文章將介紹使用 GCP 開啟第三方登入驗證"></a>本文章將介紹使用 GCP 開啟第三方登入驗證</h2><h3 id="一、建立-google-憑證，到導覽選單-API-和服務-→-憑證"><a href="#一、建立-google-憑證，到導覽選單-API-和服務-→-憑證" class="headerlink" title="一、建立 google 憑證，到導覽選單 API 和服務 → 憑證"></a>一、建立 google 憑證，到導覽選單 API 和服務 → 憑證</h3><p><img src="images/1.png" alt=" "></p>
<h3 id="二、到分頁-OAuth-同意畫面，輸入應用程式名稱，再到支援電子郵件底下，選取您想顯示為公開聯絡人的電子郵件地址，您必須擁有這個電子郵件地址或-Google-群組，輸入以授權網域，點選儲存"><a href="#二、到分頁-OAuth-同意畫面，輸入應用程式名稱，再到支援電子郵件底下，選取您想顯示為公開聯絡人的電子郵件地址，您必須擁有這個電子郵件地址或-Google-群組，輸入以授權網域，點選儲存" class="headerlink" title="二、到分頁 OAuth 同意畫面，輸入應用程式名稱，再到支援電子郵件底下，選取您想顯示為公開聯絡人的電子郵件地址，您必須擁有這個電子郵件地址或 Google 群組，輸入以授權網域，點選儲存"></a>二、到分頁 OAuth 同意畫面，輸入應用程式名稱，再到支援電子郵件底下，選取您想顯示為公開聯絡人的電子郵件地址，您必須擁有這個電子郵件地址或 Google 群組，輸入以授權網域，點選儲存</h3><p><img src="images/2.png" alt=" "><br><img src="images/3.png" alt=" "></p>
<h3 id="三、到憑證頁面點選建立憑證，選擇-OAuth-用戶端-ID"><a href="#三、到憑證頁面點選建立憑證，選擇-OAuth-用戶端-ID" class="headerlink" title="三、到憑證頁面點選建立憑證，選擇 OAuth 用戶端 ID"></a>三、到憑證頁面點選建立憑證，選擇 OAuth 用戶端 ID</h3><p><img src="images/4.png" alt=" "></p>
<h3 id="四、點選網路應用程式"><a href="#四、點選網路應用程式" class="headerlink" title="四、點選網路應用程式"></a>四、點選網路應用程式</h3><p><img src="images/5.png" alt=" "></p>
<h3 id="五、輸入名稱，然後在已授權的重新導向-URL-輸入網域名稱，記得要加-login-google-輸入完後點選建立"><a href="#五、輸入名稱，然後在已授權的重新導向-URL-輸入網域名稱，記得要加-login-google-輸入完後點選建立" class="headerlink" title="五、輸入名稱，然後在已授權的重新導向 URL 輸入網域名稱，記得要加 /login/google 輸入完後點選建立"></a>五、輸入名稱，然後在已授權的重新導向 URL 輸入網域名稱，記得要加 /login/google 輸入完後點選建立</h3><p><img src="images/6.png" alt=" "></p>
<h3 id="六、建立完後畫面會顯示用戶端-ID-跟用戶端密鑰，這個等等指令會用到"><a href="#六、建立完後畫面會顯示用戶端-ID-跟用戶端密鑰，這個等等指令會用到" class="headerlink" title="六、建立完後畫面會顯示用戶端 ID 跟用戶端密鑰，這個等等指令會用到"></a>六、建立完後畫面會顯示用戶端 ID 跟用戶端密鑰，這個等等指令會用到</h3><p><img src="images/7.png" alt=" "></p>
<h3 id="如果忘記複製到，回到憑證畫面會看到你建好的憑證，點選右邊鉛筆編輯就可以看到了"><a href="#如果忘記複製到，回到憑證畫面會看到你建好的憑證，點選右邊鉛筆編輯就可以看到了" class="headerlink" title="如果忘記複製到，回到憑證畫面會看到你建好的憑證，點選右邊鉛筆編輯就可以看到了"></a>如果忘記複製到，回到憑證畫面會看到你建好的憑證，點選右邊鉛筆編輯就可以看到了</h3><p><img src="images/8.png" alt=" "><br><img src="images/9.png" alt=" "></p>
<h3 id="七、在來回到-VM-開始建立-grafana"><a href="#七、在來回到-VM-開始建立-grafana" class="headerlink" title="七、在來回到 VM 開始建立 grafana"></a>七、在來回到 VM 開始建立 grafana</h3><h3 id="grafana-建立文章-傳送門"><a href="#grafana-建立文章-傳送門" class="headerlink" title="grafana 建立文章 傳送門"></a>grafana 建立文章 <a href="https://snoopy30485.github.io/2018/08/02/grafana%E5%BB%BA%E7%AB%8B/" target="_blank" rel="noopener">傳送門</a></h3><h3 id="因為是開啟第三方登入驗證，所已建-grafana-會再多幾行指令"><a href="#因為是開啟第三方登入驗證，所已建-grafana-會再多幾行指令" class="headerlink" title="因為是開啟第三方登入驗證，所已建 grafana 會再多幾行指令"></a>因為是開啟第三方登入驗證，所已建 grafana 會再多幾行指令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name grafana --user root -p 80:3000 -v /data/grafana:/var/lib/grafana --link influxdb:influxdb --restart=always -e GF_SERVER_ROOT_URL=http://grafana.costworlds.com -e GF_AUTH_DISABLE_LOGIN_FORM=false -e GF_AUTH_GOOGLE_ENABLED=true -e GF_AUTH_GOOGLE_CLIENT_ID=33574658051-0f9glecg4ujag71t3r2r6i96lc1bdgqe.apps.googleusercontent.com -e GF_AUTH_GOOGLE_CLIENT_SECRET=NNDaKWcBni51U7Ya4uYL6-Ay -e GF_AUTH_GOOGLE_ALLOWED_DOMAINS=gmail.com -e GF_AUTH_GOOGLE_ALLOW_SIGN_UP=true grafana/grafana:5.2.4</span><br></pre></td></tr></table></figure>
<h3 id="多出指令："><a href="#多出指令：" class="headerlink" title="多出指令："></a>多出指令：</h3><h3 id="GF-SERVER-ROOT-URL：指定-grafana-網站的使用網域，有租網域給該-grafana-服務使用的話可以利用此設定"><a href="#GF-SERVER-ROOT-URL：指定-grafana-網站的使用網域，有租網域給該-grafana-服務使用的話可以利用此設定" class="headerlink" title="GF_SERVER_ROOT_URL：指定 grafana 網站的使用網域，有租網域給該 grafana 服務使用的話可以利用此設定"></a>GF_SERVER_ROOT_URL：指定 grafana 網站的使用網域，有租網域給該 grafana 服務使用的話可以利用此設定</h3><h3 id="GF-AUTH-DISABLE-LOGIN-FORM：輸入帳號密碼功能的顯示，如果需要輸入帳號密碼與-google-第三方驗證登入同時存在的話這邊設定-false"><a href="#GF-AUTH-DISABLE-LOGIN-FORM：輸入帳號密碼功能的顯示，如果需要輸入帳號密碼與-google-第三方驗證登入同時存在的話這邊設定-false" class="headerlink" title="GF_AUTH_DISABLE_LOGIN_FORM：輸入帳號密碼功能的顯示，如果需要輸入帳號密碼與 google 第三方驗證登入同時存在的話這邊設定 false"></a>GF_AUTH_DISABLE_LOGIN_FORM：輸入帳號密碼功能的顯示，如果需要輸入帳號密碼與 google 第三方驗證登入同時存在的話這邊設定 false</h3><h3 id="GF-AUTH-GOOGLE-ENABLED：開啟google第三方登入驗證功能"><a href="#GF-AUTH-GOOGLE-ENABLED：開啟google第三方登入驗證功能" class="headerlink" title="GF_AUTH_GOOGLE_ENABLED：開啟google第三方登入驗證功能"></a>GF_AUTH_GOOGLE_ENABLED：開啟google第三方登入驗證功能</h3><h3 id="GF-AUTH-GOOGLE-CLIENT-ID：google-驗證客端的-ID，可以至-GCP-上的-API-和憑證中的憑證後點選建立憑證-→-OAuth-用戶端ID建立後或給予一組用戶端-ID-可以填寫在此。注意這邊需要先到-OAuth-同意畫面新增已授權網域並選擇公開"><a href="#GF-AUTH-GOOGLE-CLIENT-ID：google-驗證客端的-ID，可以至-GCP-上的-API-和憑證中的憑證後點選建立憑證-→-OAuth-用戶端ID建立後或給予一組用戶端-ID-可以填寫在此。注意這邊需要先到-OAuth-同意畫面新增已授權網域並選擇公開" class="headerlink" title="GF_AUTH_GOOGLE_CLIENT_ID：google 驗證客端的 ID，可以至 GCP 上的 API 和憑證中的憑證後點選建立憑證 → OAuth 用戶端ID建立後或給予一組用戶端 ID 可以填寫在此。注意這邊需要先到 OAuth 同意畫面新增已授權網域並選擇公開"></a>GF_AUTH_GOOGLE_CLIENT_ID：google 驗證客端的 ID，可以至 GCP 上的 API 和憑證中的憑證後點選建立憑證 → OAuth 用戶端ID建立後或給予一組用戶端 ID 可以填寫在此。注意這邊需要先到 OAuth 同意畫面新增已授權網域並選擇公開</h3><h3 id="GF-AUTH-GOOGLE-CLIENT-SECRET：google-驗證客端的密碼，同上在建立-OAuth2-0-用戶端-ID-的時候會同時給予密碼"><a href="#GF-AUTH-GOOGLE-CLIENT-SECRET：google-驗證客端的密碼，同上在建立-OAuth2-0-用戶端-ID-的時候會同時給予密碼" class="headerlink" title="GF_AUTH_GOOGLE_CLIENT_SECRET：google 驗證客端的密碼，同上在建立 OAuth2.0 用戶端 ID 的時候會同時給予密碼"></a>GF_AUTH_GOOGLE_CLIENT_SECRET：google 驗證客端的密碼，同上在建立 OAuth2.0 用戶端 ID 的時候會同時給予密碼</h3><h3 id="GF-AUTH-GOOGLE-ALLOWED-DOMAINS：允許認證的登入的網域，也就是說你需要設定什麼帳號的網域登入-google-成功後才可以轉導登入進-grafana"><a href="#GF-AUTH-GOOGLE-ALLOWED-DOMAINS：允許認證的登入的網域，也就是說你需要設定什麼帳號的網域登入-google-成功後才可以轉導登入進-grafana" class="headerlink" title="GF_AUTH_GOOGLE_ALLOWED_DOMAINS：允許認證的登入的網域，也就是說你需要設定什麼帳號的網域登入 google 成功後才可以轉導登入進 grafana"></a>GF_AUTH_GOOGLE_ALLOWED_DOMAINS：允許認證的登入的網域，也就是說你需要設定什麼帳號的網域登入 google 成功後才可以轉導登入進 grafana</h3><h3 id="GF-AUTH-GOOGLE-ALLOW-SIGN-UP：允許-google-驗證登入"><a href="#GF-AUTH-GOOGLE-ALLOW-SIGN-UP：允許-google-驗證登入" class="headerlink" title="GF_AUTH_GOOGLE_ALLOW_SIGN_UP：允許 google 驗證登入"></a>GF_AUTH_GOOGLE_ALLOW_SIGN_UP：允許 google 驗證登入</h3><h3 id="docker-compose"><a href="#docker-compose" class="headerlink" title="docker-compose"></a>docker-compose</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">version: &quot;2&quot;</span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line"></span><br><span class="line">  influxdb:</span><br><span class="line">    container_name: influxdb</span><br><span class="line">    image: influxdb:1.7.2</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;8086:8086&quot;</span><br><span class="line">      - &quot;8083:8083&quot;</span><br><span class="line">    restart: always</span><br><span class="line">    volumes:</span><br><span class="line">      - /data/influxdb:/var/lib/influxdb</span><br><span class="line">    environment:</span><br><span class="line">      - &quot;ES_JAVA_OPTS=-Xms2g -Xmx2g&quot;</span><br><span class="line">    networks:</span><br><span class="line">      - grafana</span><br><span class="line"></span><br><span class="line">  grafana:</span><br><span class="line">    container_name: grafana</span><br><span class="line">    image: grafana/grafana:5.2.4</span><br><span class="line">    user: root</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;80:3000&quot;</span><br><span class="line">    volumes:</span><br><span class="line">      - /data/grafana:/var/lib/grafana</span><br><span class="line">    restart: always</span><br><span class="line">    environment:</span><br><span class="line">      - GF_AUTH_GOOGLE_ALLOWED_DOMAINS=grafana.costworlds.com</span><br><span class="line">      -e GF_AUTH_DISABLE_LOGIN_FORM=false -e GF_AUTH_GOOGLE_ENABLED=true </span><br><span class="line">      -e GF_AUTH_GOOGLE_CLIENT_ID=33574658051-0f9glecg4ujag71t3r2r6i96lc1bdgqe.apps.googleusercontent.com </span><br><span class="line">      -e GF_AUTH_GOOGLE_CLIENT_SECRET=NNDaKWcBni51U7Ya4uYL6-Ay </span><br><span class="line">      -e GF_AUTH_GOOGLE_ALLOWED_DOMAINS=gmail.com </span><br><span class="line">      -e GF_AUTH_GOOGLE_ALLOW_SIGN_UP=true</span><br><span class="line">    networks:</span><br><span class="line">      - grafana</span><br><span class="line">    depends_on:</span><br><span class="line">      - influxdb</span><br><span class="line"></span><br><span class="line">networks:</span><br><span class="line">  grafana:</span><br><span class="line">    driver: bridge</span><br></pre></td></tr></table></figure>
<h3 id="八、測試，開啟網頁使用-google-帳號可以登入就是成功了"><a href="#八、測試，開啟網頁使用-google-帳號可以登入就是成功了" class="headerlink" title="八、測試，開啟網頁使用 google 帳號可以登入就是成功了"></a>八、測試，開啟網頁使用 google 帳號可以登入就是成功了</h3><p><img src="images/10.png" alt=" "><br><img src="images/11.png" alt=" "><br><img src="images/12.png" alt=" "></p>
<h3 id="如果把-GF-AUTH-DISABLE-LOGIN-FORM-設定為-true，就只能使用-google-登入了"><a href="#如果把-GF-AUTH-DISABLE-LOGIN-FORM-設定為-true，就只能使用-google-登入了" class="headerlink" title="如果把 GF_AUTH_DISABLE_LOGIN_FORM 設定為 true，就只能使用 google 登入了"></a>如果把 GF_AUTH_DISABLE_LOGIN_FORM 設定為 true，就只能使用 google 登入了</h3><p><img src="images/13.png" alt=" "></p>
<h3 id="到這邊第三方驗證登入就完成了"><a href="#到這邊第三方驗證登入就完成了" class="headerlink" title="到這邊第三方驗證登入就完成了"></a>到這邊第三方驗證登入就完成了</h3>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/02/grafana使用網域開啟監控頁面/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/unnamed.gif">
      <meta itemprop="name" content="緣分到了，文件自然就做好了！">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/08/02/grafana使用網域開啟監控頁面/" class="post-title-link" itemprop="url">grafana使用網域開啟監控頁面</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Publicado el</span>

              <time title="Creado por: 2018-08-02 17:59:38" itemprop="dateCreated datePublished" datetime="2018-08-02T17:59:38+08:00">2018-08-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Editado el</span>
                <time title="Modificado por: 2020-04-01 11:30:25" itemprop="dateModified" datetime="2020-04-01T11:30:25+08:00">2020-04-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="本文章將介紹使用-GCP-加入-DNS-網域開啟-grafana-監控頁面"><a href="#本文章將介紹使用-GCP-加入-DNS-網域開啟-grafana-監控頁面" class="headerlink" title="本文章將介紹使用 GCP 加入 DNS 網域開啟 grafana 監控頁面"></a>本文章將介紹使用 GCP 加入 DNS 網域開啟 grafana 監控頁面</h2><h3 id="在-GCP-加入-DNS-網域文章-傳送門"><a href="#在-GCP-加入-DNS-網域文章-傳送門" class="headerlink" title="在 GCP 加入 DNS 網域文章 傳送門"></a>在 GCP 加入 DNS 網域文章 <a href="https://snoopy30485.github.io/2018/06/20/GCP-%E8%A8%AD%E5%AE%9ADNS%E7%B6%B2%E5%9F%9F/" target="_blank" rel="noopener">傳送門</a></h3><h3 id="GCP-網域加好後，只需要在指令多加-e-GF-AUTH-GOOGLE-ALLOWED-DOMAINS-”你的網域”-這樣就可以使用網域開啟監控頁面"><a href="#GCP-網域加好後，只需要在指令多加-e-GF-AUTH-GOOGLE-ALLOWED-DOMAINS-”你的網域”-這樣就可以使用網域開啟監控頁面" class="headerlink" title="GCP 網域加好後，只需要在指令多加 -e GF_AUTH_GOOGLE_ALLOWED_DOMAINS=”你的網域” 這樣就可以使用網域開啟監控頁面"></a>GCP 網域加好後，只需要在指令多加 -e GF_AUTH_GOOGLE_ALLOWED_DOMAINS=”你的網域” 這樣就可以使用網域開啟監控頁面</h3><h3 id="grafana-建立文章-傳送門"><a href="#grafana-建立文章-傳送門" class="headerlink" title="grafana 建立文章 傳送門"></a>grafana 建立文章 <a href="https://snoopy30485.github.io/2018/08/02/grafana%E5%BB%BA%E7%AB%8B/" target="_blank" rel="noopener">傳送門</a></h3><h3 id="grafana-指令-本章使用的網域為-grafana-costworlds-com"><a href="#grafana-指令-本章使用的網域為-grafana-costworlds-com" class="headerlink" title="grafana 指令 ( 本章使用的網域為 grafana.costworlds.com )"></a>grafana 指令 ( 本章使用的網域為 grafana.costworlds.com )</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name grafana --restart=always -p 80:3000 -v /data/grafana:/var/lib/grafana --user root --link influxdb:influxdb -e GF_AUTH_GOOGLE_ALLOWED_DOMAINS=grafana.costworlds.com grafana/grafana:5.2.4</span><br></pre></td></tr></table></figure>
<h3 id="docker-compose"><a href="#docker-compose" class="headerlink" title="docker-compose"></a>docker-compose</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">version: &quot;2&quot;</span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line"></span><br><span class="line">  influxdb:</span><br><span class="line">    container_name: influxdb</span><br><span class="line">    image: influxdb:1.7.2</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;8086:8086&quot;</span><br><span class="line">      - &quot;8083:8083&quot;</span><br><span class="line">    restart: always</span><br><span class="line">    volumes:</span><br><span class="line">      - /data/influxdb:/var/lib/influxdb</span><br><span class="line">    environment:</span><br><span class="line">      - &quot;ES_JAVA_OPTS=-Xms2g -Xmx2g&quot;</span><br><span class="line">    networks:</span><br><span class="line">      - grafana</span><br><span class="line"></span><br><span class="line">  grafana:</span><br><span class="line">    container_name: grafana</span><br><span class="line">    image: grafana/grafana:5.2.4</span><br><span class="line">    user: root</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;80:3000&quot;</span><br><span class="line">    volumes:</span><br><span class="line">      - /data/grafana:/var/lib/grafana</span><br><span class="line">    restart: always</span><br><span class="line">    environment:</span><br><span class="line">      - GF_AUTH_GOOGLE_ALLOWED_DOMAINS=grafana.costworlds.com</span><br><span class="line">    networks:</span><br><span class="line">      - grafana</span><br><span class="line">    depends_on:</span><br><span class="line">      - influxdb</span><br><span class="line"></span><br><span class="line">networks:</span><br><span class="line">  grafana:</span><br><span class="line">    driver: bridge</span><br></pre></td></tr></table></figure>
<h3 id="測試，直接使用網域開啟監控頁面，看到畫面就成功了"><a href="#測試，直接使用網域開啟監控頁面，看到畫面就成功了" class="headerlink" title="測試，直接使用網域開啟監控頁面，看到畫面就成功了"></a>測試，直接使用網域開啟監控頁面，看到畫面就成功了</h3><p><img src="images/1.png" alt=" "></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/02/grafana建立/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/unnamed.gif">
      <meta itemprop="name" content="緣分到了，文件自然就做好了！">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/08/02/grafana建立/" class="post-title-link" itemprop="url">grafana建立</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Publicado el</span>

              <time title="Creado por: 2018-08-02 17:59:37" itemprop="dateCreated datePublished" datetime="2018-08-02T17:59:37+08:00">2018-08-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Editado el</span>
                <time title="Modificado por: 2020-04-01 11:30:25" itemprop="dateModified" datetime="2020-04-01T11:30:25+08:00">2020-04-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="什麼是-Grafana-？"><a href="#什麼是-Grafana-？" class="headerlink" title="什麼是 Grafana ？"></a>什麼是 Grafana ？</h3><h4 id="Grafana-是一套開源的監控及分析平台軟體，可支援許多不同的資料來源為其一大特點，從常用的-CloudWatch、Elasticsearch、Graphite、influxDB-到-OpenStack-的-Gnocchi-或-Google-Calendar-等，範圍十分的廣泛，管理者不會因為受限於不同的資料來源而必需使用不同的監控軟體。Grafana-具備豐富的面板選擇，除了基本文字、圖表、表格等，管理者亦可使用如甘特圖、流程圖等面板來顯示所監控的資料及訊息，並可由管理者自行調整顯示資料的色彩"><a href="#Grafana-是一套開源的監控及分析平台軟體，可支援許多不同的資料來源為其一大特點，從常用的-CloudWatch、Elasticsearch、Graphite、influxDB-到-OpenStack-的-Gnocchi-或-Google-Calendar-等，範圍十分的廣泛，管理者不會因為受限於不同的資料來源而必需使用不同的監控軟體。Grafana-具備豐富的面板選擇，除了基本文字、圖表、表格等，管理者亦可使用如甘特圖、流程圖等面板來顯示所監控的資料及訊息，並可由管理者自行調整顯示資料的色彩" class="headerlink" title="Grafana 是一套開源的監控及分析平台軟體，可支援許多不同的資料來源為其一大特點，從常用的 CloudWatch、Elasticsearch、Graphite、influxDB 到 OpenStack 的 Gnocchi 或 Google Calendar 等，範圍十分的廣泛，管理者不會因為受限於不同的資料來源而必需使用不同的監控軟體。Grafana 具備豐富的面板選擇，除了基本文字、圖表、表格等，管理者亦可使用如甘特圖、流程圖等面板來顯示所監控的資料及訊息，並可由管理者自行調整顯示資料的色彩"></a>Grafana 是一套開源的監控及分析平台軟體，可支援許多不同的資料來源為其一大特點，從常用的 CloudWatch、Elasticsearch、Graphite、influxDB 到 OpenStack 的 Gnocchi 或 Google Calendar 等，範圍十分的廣泛，管理者不會因為受限於不同的資料來源而必需使用不同的監控軟體。Grafana 具備豐富的面板選擇，除了基本文字、圖表、表格等，管理者亦可使用如甘特圖、流程圖等面板來顯示所監控的資料及訊息，並可由管理者自行調整顯示資料的色彩</h4><h3 id="什麼是-InfluxDB-？"><a href="#什麼是-InfluxDB-？" class="headerlink" title="什麼是 InfluxDB ？"></a>什麼是 InfluxDB ？</h3><h4 id="InfluxDB-是一個由-InfluxData-開發的開源時序型資料庫。它由-Go-寫成，著力於高性能地查詢與存儲時序型數據，InfluxDB-被廣泛應用於存儲系統的監控數據"><a href="#InfluxDB-是一個由-InfluxData-開發的開源時序型資料庫。它由-Go-寫成，著力於高性能地查詢與存儲時序型數據，InfluxDB-被廣泛應用於存儲系統的監控數據" class="headerlink" title="InfluxDB 是一個由 InfluxData 開發的開源時序型資料庫。它由 Go 寫成，著力於高性能地查詢與存儲時序型數據，InfluxDB 被廣泛應用於存儲系統的監控數據"></a>InfluxDB 是一個由 InfluxData 開發的開源時序型資料庫。它由 Go 寫成，著力於高性能地查詢與存儲時序型數據，InfluxDB 被廣泛應用於存儲系統的監控數據</h4><hr>
<h4 id="Grafana-建立，本文章將使用-ubuntu-16-04、grafana：5-2-4、influxdb：1-7-2"><a href="#Grafana-建立，本文章將使用-ubuntu-16-04、grafana：5-2-4、influxdb：1-7-2" class="headerlink" title="Grafana 建立，本文章將使用 ubuntu 16.04、grafana：5.2.4、influxdb：1.7.2"></a>Grafana 建立，本文章將使用 ubuntu 16.04、grafana：5.2.4、influxdb：1.7.2</h4><h4 id="一、指令建立-grafana-和-influxdb"><a href="#一、指令建立-grafana-和-influxdb" class="headerlink" title="一、指令建立 grafana 和 influxdb"></a>一、指令建立 grafana 和 influxdb</h4><h4 id="前置作業"><a href="#前置作業" class="headerlink" title="前置作業"></a>前置作業</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
<h4 id="安裝-docker"><a href="#安裝-docker" class="headerlink" title="安裝 docker"></a>安裝 docker</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get -y install docker.io</span><br></pre></td></tr></table></figure>
<h4 id="下載-influxdb-並-run-起來"><a href="#下載-influxdb-並-run-起來" class="headerlink" title="下載 influxdb 並 run 起來"></a>下載 influxdb 並 run 起來</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name influxdb --restart=always -p 8083:8083 -p 8086:8086 -v /data/influxdb:/var/lib/influxdb -e ES_JAVA_OPTS:-Xmx2g -e ES_JAVA_OPTS:-Xms2g influxdb</span><br></pre></td></tr></table></figure>
<h4 id="參數介紹："><a href="#參數介紹：" class="headerlink" title="參數介紹："></a>參數介紹：</h4><h4 id="d：背景執行"><a href="#d：背景執行" class="headerlink" title="-d：背景執行"></a>-d：背景執行</h4><h4 id="v：持久化，設定容器儲存-LOG-路徑-var-lib-influxdb-同步一份到我們指定路徑-data-influxdb"><a href="#v：持久化，設定容器儲存-LOG-路徑-var-lib-influxdb-同步一份到我們指定路徑-data-influxdb" class="headerlink" title="-v：持久化，設定容器儲存 LOG 路徑 /var/lib/influxdb 同步一份到我們指定路徑 /data/influxdb"></a>-v：持久化，設定容器儲存 LOG 路徑 /var/lib/influxdb 同步一份到我們指定路徑 /data/influxdb</h4><h4 id="–name：Container-命名"><a href="#–name：Container-命名" class="headerlink" title="–name：Container 命名"></a>–name：Container 命名</h4><h4 id="p：設定-port號"><a href="#p：設定-port號" class="headerlink" title="-p：設定 port號"></a>-p：設定 port號</h4><h4 id="–restart-always：機器重啟後-Container-自動重啟（預設是關閉）"><a href="#–restart-always：機器重啟後-Container-自動重啟（預設是關閉）" class="headerlink" title="–restart=always：機器重啟後 Container 自動重啟（預設是關閉）"></a>–restart=always：機器重啟後 Container 自動重啟（預設是關閉）</h4><h4 id="–link：Container-互聯"><a href="#–link：Container-互聯" class="headerlink" title="–link：Container 互聯"></a>–link：Container 互聯</h4><h4 id="ES-JAVA-OPTS-”-Xms2g-Xmx2g”：設定記憶體可使用上限"><a href="#ES-JAVA-OPTS-”-Xms2g-Xmx2g”：設定記憶體可使用上限" class="headerlink" title="ES_JAVA_OPTS=”-Xms2g -Xmx2g”：設定記憶體可使用上限"></a>ES_JAVA_OPTS=”-Xms2g -Xmx2g”：設定記憶體可使用上限</h4><h4 id="–user-root：因為-grafana-在-5-1-0-之前是使用-root-權限-run-起來的，但是在這之後版本沒有這樣做所以要多下一個-–user-root-指令"><a href="#–user-root：因為-grafana-在-5-1-0-之前是使用-root-權限-run-起來的，但是在這之後版本沒有這樣做所以要多下一個-–user-root-指令" class="headerlink" title="–user root：因為 grafana 在 5.1.0 之前是使用 root 權限 run 起來的，但是在這之後版本沒有這樣做所以要多下一個 –user root 指令"></a>–user root：因為 grafana 在 5.1.0 之前是使用 root 權限 run 起來的，但是在這之後版本沒有這樣做所以要多下一個 –user root 指令</h4><h4 id="下載-grafana-並-run-起來"><a href="#下載-grafana-並-run-起來" class="headerlink" title="下載 grafana 並 run 起來"></a>下載 grafana 並 run 起來</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name grafana --restart=always -p 80:3000 -v /data/grafana:/var/lib/grafana --user root --link influxdb:influxdb grafana/grafana:5.2.4</span><br></pre></td></tr></table></figure>
<h4 id="使用指令查看容器狀態"><a href="#使用指令查看容器狀態" class="headerlink" title="使用指令查看容器狀態"></a>使用指令查看容器狀態</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker ps -a</span><br></pre></td></tr></table></figure>
<h4 id="二、使用-docker-compose-建立-grafana-和-influxdb"><a href="#二、使用-docker-compose-建立-grafana-和-influxdb" class="headerlink" title="二、使用 docker-compose 建立 grafana 和 influxdb"></a>二、使用 docker-compose 建立 grafana 和 influxdb</h4><h4 id="一開始指令是練習用的，等熟悉後用-docker-compose-可以快速搞定，不需要再一行行指令下"><a href="#一開始指令是練習用的，等熟悉後用-docker-compose-可以快速搞定，不需要再一行行指令下" class="headerlink" title="一開始指令是練習用的，等熟悉後用 docker-compose 可以快速搞定，不需要再一行行指令下"></a>一開始指令是練習用的，等熟悉後用 docker-compose 可以快速搞定，不需要再一行行指令下</h4><h4 id="安裝-docker-compose"><a href="#安裝-docker-compose" class="headerlink" title="安裝 docker-compose"></a>安裝 docker-compose</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get -y install docker-compose</span><br></pre></td></tr></table></figure>
<h4 id="建立-docker-compose"><a href="#建立-docker-compose" class="headerlink" title="建立 docker-compose"></a>建立 docker-compose</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi docker-compose.yml</span><br></pre></td></tr></table></figure>
<h4 id="docker-compose-內容"><a href="#docker-compose-內容" class="headerlink" title="docker-compose 內容"></a>docker-compose 內容</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">version: &quot;2&quot;</span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line"></span><br><span class="line">  influxdb:</span><br><span class="line">    container_name: influxdb</span><br><span class="line">    image: influxdb:1.7.2</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;8086:8086&quot;</span><br><span class="line">      - &quot;8083:8083&quot;</span><br><span class="line">    restart: always</span><br><span class="line">    volumes:</span><br><span class="line">      - /data/influxdb:/var/lib/influxdb</span><br><span class="line">    environment:</span><br><span class="line">      - &quot;ES_JAVA_OPTS=-Xms2g -Xmx2g&quot;</span><br><span class="line">    networks:</span><br><span class="line">      - grafana</span><br><span class="line"></span><br><span class="line">  grafana:</span><br><span class="line">    container_name: grafana</span><br><span class="line">    image: grafana/grafana:5.2.4</span><br><span class="line">    user: root</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;80:3000&quot;</span><br><span class="line">    volumes:</span><br><span class="line">      - /data/grafana:/var/lib/grafana</span><br><span class="line">    restart: always</span><br><span class="line">    networks:</span><br><span class="line">      - grafana</span><br><span class="line">    depends_on:</span><br><span class="line">      - influxdb</span><br><span class="line"></span><br><span class="line">networks:</span><br><span class="line">  grafana:</span><br><span class="line">    driver: bridge</span><br></pre></td></tr></table></figure>
<h4 id="run-docker-compose"><a href="#run-docker-compose" class="headerlink" title="run docker-compose"></a>run docker-compose</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>
<h4 id="三、測試開啟-grafana-監控頁面"><a href="#三、測試開啟-grafana-監控頁面" class="headerlink" title="三、測試開啟 grafana 監控頁面"></a>三、測試開啟 grafana 監控頁面</h4><h4 id="打開網頁輸入機器外網-IP，因為有下-p-80-3000-指令所以是以-80-port-開啟監控頁面直接打-IP-就可以了，如果沒有要加上-3000"><a href="#打開網頁輸入機器外網-IP，因為有下-p-80-3000-指令所以是以-80-port-開啟監控頁面直接打-IP-就可以了，如果沒有要加上-3000" class="headerlink" title="打開網頁輸入機器外網 IP，因為有下 -p 80:3000 指令所以是以 80 port 開啟監控頁面直接打 IP 就可以了，如果沒有要加上 3000"></a>打開網頁輸入機器外網 IP，因為有下 -p 80:3000 指令所以是以 80 port 開啟監控頁面直接打 IP 就可以了，如果沒有要加上 3000</h4><h4 id="以本篇文章為例-IP-為-35-229-184-95，如果沒用-80-port-開啟-grafana-監控頁面請輸入-35-229-184-95-3000"><a href="#以本篇文章為例-IP-為-35-229-184-95，如果沒用-80-port-開啟-grafana-監控頁面請輸入-35-229-184-95-3000" class="headerlink" title="以本篇文章為例 IP 為 35.229.184.95，如果沒用 80 port 開啟 grafana 監控頁面請輸入 35.229.184.95:3000"></a>以本篇文章為例 IP 為 35.229.184.95，如果沒用 80 port 開啟 grafana 監控頁面請輸入 35.229.184.95:3000</h4><h4 id="預設帳密為：admin、admin"><a href="#預設帳密為：admin、admin" class="headerlink" title="預設帳密為：admin、admin"></a>預設帳密為：admin、admin</h4><p><img src="images/1.png" alt=" "></p>
<h4 id="測試登入成功後到這邊就建立完成了"><a href="#測試登入成功後到這邊就建立完成了" class="headerlink" title="測試登入成功後到這邊就建立完成了"></a>測試登入成功後到這邊就建立完成了</h4><p><img src="images/2.png" alt=" "></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/01/kibana操作-Visualize、Dashboard/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/unnamed.gif">
      <meta itemprop="name" content="緣分到了，文件自然就做好了！">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/08/01/kibana操作-Visualize、Dashboard/" class="post-title-link" itemprop="url">kibana操作-Visualize、Dashboard</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Publicado el</span>

              <time title="Creado por: 2018-08-01 17:06:54" itemprop="dateCreated datePublished" datetime="2018-08-01T17:06:54+08:00">2018-08-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Editado el</span>
                <time title="Modificado por: 2020-04-01 11:30:25" itemprop="dateModified" datetime="2020-04-01T11:30:25+08:00">2020-04-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="kibana-操作-Visualize、Dashboard、版本：5-6-7"><a href="#kibana-操作-Visualize、Dashboard、版本：5-6-7" class="headerlink" title="kibana 操作-Visualize、Dashboard、版本：5.6.7"></a>kibana 操作-Visualize、Dashboard、版本：5.6.7</h3><h3 id="Visualize-將搜尋出的數據以長條圖、圓餅圖、表格等方式呈現"><a href="#Visualize-將搜尋出的數據以長條圖、圓餅圖、表格等方式呈現" class="headerlink" title="Visualize : 將搜尋出的數據以長條圖、圓餅圖、表格等方式呈現"></a>Visualize : 將搜尋出的數據以長條圖、圓餅圖、表格等方式呈現</h3><h3 id="1-點選-然後選擇想要新增的圖表"><a href="#1-點選-然後選擇想要新增的圖表" class="headerlink" title="1. 點選 + 然後選擇想要新增的圖表"></a>1. 點選 + 然後選擇想要新增的圖表</h3><p><img src="images/1.png" alt=" "><br><img src="images/2.png" alt=" "></p>
<h3 id="2-選擇要圖表畫的-index"><a href="#2-選擇要圖表畫的-index" class="headerlink" title="2. 選擇要圖表畫的 index"></a>2. 選擇要圖表畫的 index</h3><p><img src="images/3.png" alt=" "></p>
<h3 id="3-設定參數"><a href="#3-設定參數" class="headerlink" title="3. 設定參數"></a>3. 設定參數</h3><p><img src="images/4.png" alt=" "></p>
<h3 id="4-儲存圖表"><a href="#4-儲存圖表" class="headerlink" title="4. 儲存圖表"></a>4. 儲存圖表</h3><h3 id="A-點-圖表才會顯示你參數設定需要的-log"><a href="#A-點-圖表才會顯示你參數設定需要的-log" class="headerlink" title="A. 點  圖表才會顯示你參數設定需要的 log"></a>A. 點 <img src="images/5.png" alt=" "> 圖表才會顯示你參數設定需要的 log</h3><h3 id="B-有時侯設定好卻沒-log-出現，那是現在這個時間沒有此-log-預設是現在15分鐘"><a href="#B-有時侯設定好卻沒-log-出現，那是現在這個時間沒有此-log-預設是現在15分鐘" class="headerlink" title="B. 有時侯設定好卻沒 log 出現，那是現在這個時間沒有此 log (預設是現在15分鐘)"></a>B. 有時侯設定好卻沒 log 出現，那是現在這個時間沒有此 log (預設是現在15分鐘)</h3><h3 id="C-點擊-Save-頂部菜單中的選項，命名然後單擊-Save-保存"><a href="#C-點擊-Save-頂部菜單中的選項，命名然後單擊-Save-保存" class="headerlink" title="C. 點擊 Save 頂部菜單中的選項，命名然後單擊 Save 保存"></a>C. 點擊 Save 頂部菜單中的選項，命名然後單擊 Save 保存</h3><p><img src="images/6.png" alt=" "></p>
<hr>
<h3 id="Dashboard-將-Visualize-繪製的許多圖表，整合這些資訊到同一個頁面裡"><a href="#Dashboard-將-Visualize-繪製的許多圖表，整合這些資訊到同一個頁面裡" class="headerlink" title="Dashboard : 將 Visualize 繪製的許多圖表，整合這些資訊到同一個頁面裡"></a>Dashboard : 將 Visualize 繪製的許多圖表，整合這些資訊到同一個頁面裡</h3><h3 id="1-新增要整合的視覺化圖表"><a href="#1-新增要整合的視覺化圖表" class="headerlink" title="1. 新增要整合的視覺化圖表"></a>1. 新增要整合的視覺化圖表</h3><p><img src="images/7.png" alt=" "><br><img src="images/8.png" alt=" "></p>
<h3 id="2-選擇要加入的圖表，Options-可以更換背景顏色-Add-增加新表單"><a href="#2-選擇要加入的圖表，Options-可以更換背景顏色-Add-增加新表單" class="headerlink" title="2. 選擇要加入的圖表，Options 可以更換背景顏色 Add 增加新表單"></a>2. 選擇要加入的圖表，Options 可以更換背景顏色 Add 增加新表單</h3><p><img src="images/9.png" alt=" "></p>
<h3 id="3-儲存好要更改點選-Edit-可回復上一個圖在做設定"><a href="#3-儲存好要更改點選-Edit-可回復上一個圖在做設定" class="headerlink" title="3. 儲存好要更改點選 Edit 可回復上一個圖在做設定"></a>3. 儲存好要更改點選 Edit 可回復上一個圖在做設定</h3><p><img src="images/10.png" alt=" "></p>
<h3 id="4-點擊-Save-頂部菜單中的選項，命名您的面板，然後單擊-Save-以保存為儀表板可視化，也可以在此下條件觀"><a href="#4-點擊-Save-頂部菜單中的選項，命名您的面板，然後單擊-Save-以保存為儀表板可視化，也可以在此下條件觀" class="headerlink" title="4. 點擊 Save 頂部菜單中的選項，命名您的面板，然後單擊 Save 以保存為儀表板可視化，也可以在此下條件觀"></a>4. 點擊 Save 頂部菜單中的選項，命名您的面板，然後單擊 Save 以保存為儀表板可視化，也可以在此下條件觀</h3><p><img src="images/11.png" alt=" "></p>
<h3 id="Visualize、Dashboard-基本操作結束！"><a href="#Visualize、Dashboard-基本操作結束！" class="headerlink" title="Visualize、Dashboard 基本操作結束！"></a>Visualize、Dashboard 基本操作結束！</h3>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/01/kibana操作-Discover/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/unnamed.gif">
      <meta itemprop="name" content="緣分到了，文件自然就做好了！">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/08/01/kibana操作-Discover/" class="post-title-link" itemprop="url">kibana操作-Discover</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Publicado el</span>

              <time title="Creado por: 2018-08-01 17:06:52" itemprop="dateCreated datePublished" datetime="2018-08-01T17:06:52+08:00">2018-08-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Editado el</span>
                <time title="Modificado por: 2020-04-01 11:30:25" itemprop="dateModified" datetime="2020-04-01T11:30:25+08:00">2020-04-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="kibana-操作-Discover、版本：5-6-7"><a href="#kibana-操作-Discover、版本：5-6-7" class="headerlink" title="kibana 操作-Discover、版本：5.6.7"></a>kibana 操作-Discover、版本：5.6.7</h3><h3 id="第一次進入畫面"><a href="#第一次進入畫面" class="headerlink" title="第一次進入畫面"></a>第一次進入畫面</h3><p><img src="images/1.png" alt=" "></p>
<h3 id="設定-index，本文章適用預設所以是-winlogbeat，Time-Filter-field-name-選擇-timestamp"><a href="#設定-index，本文章適用預設所以是-winlogbeat，Time-Filter-field-name-選擇-timestamp" class="headerlink" title="設定 index，本文章適用預設所以是 winlogbeat，Time Filter field name 選擇 @timestamp"></a>設定 index，本文章適用預設所以是 winlogbeat，Time Filter field name 選擇 @timestamp</h3><p><img src="images/2.png" alt=" "></p>
<h3 id="設定好後畫面"><a href="#設定好後畫面" class="headerlink" title="設定好後畫面"></a>設定好後畫面</h3><p><img src="images/14.png" alt=" "></p>
<hr>
<h3 id="Discover-做資料查詢，並檢視各索引下的記錄內容及總記錄筆數，本文章分成-5-區將一一作介紹"><a href="#Discover-做資料查詢，並檢視各索引下的記錄內容及總記錄筆數，本文章分成-5-區將一一作介紹" class="headerlink" title="Discover : 做資料查詢，並檢視各索引下的記錄內容及總記錄筆數，本文章分成 5 區將一一作介紹"></a>Discover : 做資料查詢，並檢視各索引下的記錄內容及總記錄筆數，本文章分成 5 區將一一作介紹</h3><p><img src="images/3.png" alt=" "></p>
<h3 id="1-Index-純粹看目前所在的-index-是哪一個-不再另外作介紹"><a href="#1-Index-純粹看目前所在的-index-是哪一個-不再另外作介紹" class="headerlink" title="1. Index : 純粹看目前所在的 index 是哪一個 ( 不再另外作介紹 )"></a>1. Index : 純粹看目前所在的 index 是哪一個 ( 不再另外作介紹 )</h3><h3 id="2-Avaliable-Fields-搜索-index-下所包含的欄位"><a href="#2-Avaliable-Fields-搜索-index-下所包含的欄位" class="headerlink" title="2. Avaliable Fields : 搜索 index 下所包含的欄位"></a>2. Avaliable Fields : 搜索 index 下所包含的欄位</h3><h3 id="3-Timestamp-資料時間，可用於特定時間區間資料量觀察，直接選取可以查看想要時間範圍內的-log"><a href="#3-Timestamp-資料時間，可用於特定時間區間資料量觀察，直接選取可以查看想要時間範圍內的-log" class="headerlink" title="3. Timestamp : 資料時間，可用於特定時間區間資料量觀察，直接選取可以查看想要時間範圍內的 log"></a>3. Timestamp : 資料時間，可用於特定時間區間資料量觀察，直接選取可以查看想要時間範圍內的 log</h3><h3 id="4-source-也就是我們先前所儲存的資料內容，可以展開查看更詳細內容"><a href="#4-source-也就是我們先前所儲存的資料內容，可以展開查看更詳細內容" class="headerlink" title="4. source : 也就是我們先前所儲存的資料內容，可以展開查看更詳細內容"></a>4. source : 也就是我們先前所儲存的資料內容，可以展開查看更詳細內容</h3><h3 id="5-搜尋條件儲存-預設-”-“-搜尋-index-下所有紀錄，設定需要-log-時間並儲存"><a href="#5-搜尋條件儲存-預設-”-“-搜尋-index-下所有紀錄，設定需要-log-時間並儲存" class="headerlink" title="5. 搜尋條件儲存 : 預設 ”*“ 搜尋 index 下所有紀錄，設定需要 log 時間並儲存"></a>5. 搜尋條件儲存 : 預設 ”*“ 搜尋 index 下所有紀錄，設定需要 log 時間並儲存</h3><hr>
<h3 id="各區介紹"><a href="#各區介紹" class="headerlink" title="各區介紹"></a>各區介紹</h3><h3 id="2-Avaliable-Fields-搜索-index-下所包含的欄位-1"><a href="#2-Avaliable-Fields-搜索-index-下所包含的欄位-1" class="headerlink" title="2. Avaliable Fields : 搜索 index 下所包含的欄位"></a>2. Avaliable Fields : 搜索 index 下所包含的欄位</h3><h3 id="可以選擇-add-加入，顯示自己想看的欄位"><a href="#可以選擇-add-加入，顯示自己想看的欄位" class="headerlink" title="可以選擇 add 加入，顯示自己想看的欄位"></a>可以選擇 add 加入，顯示自己想看的欄位</h3><p><img src="images/4.png" alt=" "></p>
<h3 id="點選-Available-Fields-的齒輪可以篩選欄位，以更快查詢需要的-log"><a href="#點選-Available-Fields-的齒輪可以篩選欄位，以更快查詢需要的-log" class="headerlink" title="點選 Available Fields 的齒輪可以篩選欄位，以更快查詢需要的 log"></a>點選 Available Fields 的齒輪可以篩選欄位，以更快查詢需要的 log</h3><p><img src="images/5.png" alt=" "></p>
<h3 id="如果不需要可以按-remove-移除"><a href="#如果不需要可以按-remove-移除" class="headerlink" title="如果不需要可以按 remove 移除"></a>如果不需要可以按 remove 移除</h3><p><img src="images/6.png" alt=" "></p>
<h3 id="點選放大鏡-可以直接在-source-訊息裡顯示你要的欄位"><a href="#點選放大鏡-可以直接在-source-訊息裡顯示你要的欄位" class="headerlink" title="點選放大鏡 + 可以直接在 source 訊息裡顯示你要的欄位"></a>點選放大鏡 + 可以直接在 source 訊息裡顯示你要的欄位</h3><p><img src="images/7.png" alt=" "></p>
<h3 id="Add-a-filter-可以加入自己想看的獨欄位的一種條件做-log-查詢"><a href="#Add-a-filter-可以加入自己想看的獨欄位的一種條件做-log-查詢" class="headerlink" title="Add a filter 可以加入自己想看的獨欄位的一種條件做 log 查詢"></a>Add a filter 可以加入自己想看的獨欄位的一種條件做 log 查詢</h3><p><img src="images/8.png" alt=" "></p>
<h3 id="當加入一個欄位，可以點選-Actions-做欄位的調整"><a href="#當加入一個欄位，可以點選-Actions-做欄位的調整" class="headerlink" title="當加入一個欄位，可以點選 Actions 做欄位的調整"></a>當加入一個欄位，可以點選 Actions 做欄位的調整</h3><h3 id="Enable-啟用、Disable-禁用、Pin-釘選、Unpin-取消釘選、Invert-加入或刪去欄位、Toggle-隱藏、Remove-移除"><a href="#Enable-啟用、Disable-禁用、Pin-釘選、Unpin-取消釘選、Invert-加入或刪去欄位、Toggle-隱藏、Remove-移除" class="headerlink" title="Enable 啟用、Disable 禁用、Pin 釘選、Unpin 取消釘選、Invert 加入或刪去欄位、Toggle 隱藏、Remove 移除"></a>Enable 啟用、Disable 禁用、Pin 釘選、Unpin 取消釘選、Invert 加入或刪去欄位、Toggle 隱藏、Remove 移除</h3><p><img src="images/9.png" alt=" "></p>
<h3 id="左上搜尋條件角滑鼠移上去會顯示圖案，圖案的功能其實跟點選-Actions-後出現的差不多"><a href="#左上搜尋條件角滑鼠移上去會顯示圖案，圖案的功能其實跟點選-Actions-後出現的差不多" class="headerlink" title="左上搜尋條件角滑鼠移上去會顯示圖案，圖案的功能其實跟點選 Actions 後出現的差不多"></a>左上搜尋條件角滑鼠移上去會顯示圖案，圖案的功能其實跟點選 Actions 後出現的差不多</h3><h3 id="打勾：取消後-source-就不會找出你所設定欄位"><a href="#打勾：取消後-source-就不會找出你所設定欄位" class="headerlink" title="打勾：取消後 source 就不會找出你所設定欄位"></a>打勾：取消後 source 就不會找出你所設定欄位</h3><h3 id="放大鏡-：刪去這項欄位"><a href="#放大鏡-：刪去這項欄位" class="headerlink" title="放大鏡 -：刪去這項欄位"></a>放大鏡 -：刪去這項欄位</h3><h3 id="圖釘：釘選"><a href="#圖釘：釘選" class="headerlink" title="圖釘：釘選"></a>圖釘：釘選</h3><h3 id="垃圾桶：刪除"><a href="#垃圾桶：刪除" class="headerlink" title="垃圾桶：刪除"></a>垃圾桶：刪除</h3><h3 id="框框：編輯欄位"><a href="#框框：編輯欄位" class="headerlink" title="框框：編輯欄位"></a>框框：編輯欄位</h3><p><img src="images/10.png" alt=" "></p>
<hr>
<h3 id="3-Timestamp-資料時間，可用於特定時間區間資料量觀察，直接選取可以查看想要時間範圍內的-log-1"><a href="#3-Timestamp-資料時間，可用於特定時間區間資料量觀察，直接選取可以查看想要時間範圍內的-log-1" class="headerlink" title="3. Timestamp : 資料時間，可用於特定時間區間資料量觀察，直接選取可以查看想要時間範圍內的 log"></a>3. Timestamp : 資料時間，可用於特定時間區間資料量觀察，直接選取可以查看想要時間範圍內的 log</h3><p><img src="images/11.png" alt=" "></p>
<h3 id="中間下拉式選單，可以選擇時間間隔"><a href="#中間下拉式選單，可以選擇時間間隔" class="headerlink" title="中間下拉式選單，可以選擇時間間隔"></a>中間下拉式選單，可以選擇時間間隔</h3><h3 id="millisecond-毫秒、second-秒、minute-分鐘、hourly-每小時、daily-每日、weekly-每週、monthly-每月、yearly-每年"><a href="#millisecond-毫秒、second-秒、minute-分鐘、hourly-每小時、daily-每日、weekly-每週、monthly-每月、yearly-每年" class="headerlink" title="millisecond 毫秒、second 秒、minute 分鐘、hourly 每小時、daily 每日、weekly 每週、monthly 每月、yearly 每年"></a>millisecond 毫秒、second 秒、minute 分鐘、hourly 每小時、daily 每日、weekly 每週、monthly 每月、yearly 每年</h3><p><img src="images/12.png" alt=" "></p>
<hr>
<h3 id="4-source-也就是我們先前所儲存的資料內容，可以展開查看更詳細內容-1"><a href="#4-source-也就是我們先前所儲存的資料內容，可以展開查看更詳細內容-1" class="headerlink" title="4. source : 也就是我們先前所儲存的資料內容，可以展開查看更詳細內容"></a>4. source : 也就是我們先前所儲存的資料內容，可以展開查看更詳細內容</h3><p><img src="images/13.png" alt=" "></p>
<hr>
<h3 id="5-搜尋條件儲存-預設-”-“-搜尋-index-下所有紀錄，設定需要-log-時間並儲存。"><a href="#5-搜尋條件儲存-預設-”-“-搜尋-index-下所有紀錄，設定需要-log-時間並儲存。" class="headerlink" title="5.搜尋條件儲存 : 預設 ”*“ 搜尋 index 下所有紀錄，設定需要 log 時間並儲存。"></a>5.搜尋條件儲存 : 預設 ”*“ 搜尋 index 下所有紀錄，設定需要 log 時間並儲存。</h3><h3 id="點擊右上時間會拉開-3-種時間選項"><a href="#點擊右上時間會拉開-3-種時間選項" class="headerlink" title="點擊右上時間會拉開 3 種時間選項"></a>點擊右上時間會拉開 3 種時間選項</h3><h3 id="Quick：快速選取，選擇範圍時間"><a href="#Quick：快速選取，選擇範圍時間" class="headerlink" title="Quick：快速選取，選擇範圍時間"></a>Quick：快速選取，選擇範圍時間</h3><p><img src="images/15.png" alt=" "></p>
<h3 id="Relative：相對時間，直接選擇想要的前後時間"><a href="#Relative：相對時間，直接選擇想要的前後時間" class="headerlink" title="Relative：相對時間，直接選擇想要的前後時間"></a>Relative：相對時間，直接選擇想要的前後時間</h3><h3 id="點選-set-to-Now-清空，打勾-round-to-the-day-頭時間設為-00-00-結尾時間設為-23-59"><a href="#點選-set-to-Now-清空，打勾-round-to-the-day-頭時間設為-00-00-結尾時間設為-23-59" class="headerlink" title="點選 set to Now 清空，打勾 round to the day 頭時間設為 00:00 結尾時間設為 23:59"></a>點選 set to Now 清空，打勾 round to the day 頭時間設為 00:00 結尾時間設為 23:59</h3><p><img src="images/16.png" alt=" "><br><img src="images/17.png" alt=" "></p>
<h3 id="Absolute：絕對時間，以日期來選擇前後時間"><a href="#Absolute：絕對時間，以日期來選擇前後時間" class="headerlink" title="Absolute：絕對時間，以日期來選擇前後時間"></a>Absolute：絕對時間，以日期來選擇前後時間</h3><p><img src="images/18.png" alt=" "></p>
<hr>
<h3 id="操作搜尋-log"><a href="#操作搜尋-log" class="headerlink" title="操作搜尋 log"></a>操作搜尋 log</h3><h3 id="簡單查詢語法："><a href="#簡單查詢語法：" class="headerlink" title="簡單查詢語法："></a>簡單查詢語法：</h3><h4 id="條件：AND、OR、NOT"><a href="#條件：AND、OR、NOT" class="headerlink" title="條件：AND、OR、NOT"></a>條件：AND、OR、NOT</h4><h4 id="分組：-“a”-OR-“b”-AND-“c”"><a href="#分組：-“a”-OR-“b”-AND-“c”" class="headerlink" title="分組：(“a” OR “b”) AND “c”"></a>分組：(“a” OR “b”) AND “c”</h4><h4 id="通配符：-表示0到多、-表示0或1"><a href="#通配符：-表示0到多、-表示0或1" class="headerlink" title="通配符：* 表示0到多、? 表示0或1"></a>通配符：* 表示0到多、? 表示0或1</h4><h4 id="字段搜尋：key-“value”"><a href="#字段搜尋：key-“value”" class="headerlink" title="字段搜尋：key: “value”"></a>字段搜尋：key: “value”</h4><h4 id="範圍搜尋：key-1-TO-10"><a href="#範圍搜尋：key-1-TO-10" class="headerlink" title="範圍搜尋：key: [1 TO 10]"></a>範圍搜尋：key: [1 TO 10]</h4><h4 id="轉義字元：-amp-amp-“"><a href="#轉義字元：-amp-amp-“" class="headerlink" title="轉義字元：+ - &amp;&amp; || ! () {} [] ^ “ ~ * ? :"></a>轉義字元：+ - &amp;&amp; || ! () {} [] ^ “ ~ * ? :</h4><h3 id="不記得語法-kibana-本身也有給連結，搜尋欄的最右邊點擊"><a href="#不記得語法-kibana-本身也有給連結，搜尋欄的最右邊點擊" class="headerlink" title="不記得語法 kibana 本身也有給連結，搜尋欄的最右邊點擊"></a>不記得語法 kibana 本身也有給連結，搜尋欄的最右邊點擊</h3><p><img src="images/19.png" alt=" "></p>
<h3 id="點擊後畫面"><a href="#點擊後畫面" class="headerlink" title="點擊後畫面"></a>點擊後畫面</h3><p><img src="images/20.png" alt=" "></p>
<h3 id="下條件搜尋，左上角會顯示有幾筆-log"><a href="#下條件搜尋，左上角會顯示有幾筆-log" class="headerlink" title="下條件搜尋，左上角會顯示有幾筆 log"></a>下條件搜尋，左上角會顯示有幾筆 log</h3><p><img src="images/21.png" alt=" "></p>
<h3 id="點擊-Save-頂部菜單中的選項，命名然後單擊-Save-保存，保存為當下設定好欄位條件狀態"><a href="#點擊-Save-頂部菜單中的選項，命名然後單擊-Save-保存，保存為當下設定好欄位條件狀態" class="headerlink" title="點擊 Save 頂部菜單中的選項，命名然後單擊 Save 保存，保存為當下設定好欄位條件狀態"></a>點擊 Save 頂部菜單中的選項，命名然後單擊 Save 保存，保存為當下設定好欄位條件狀態</h3><p><img src="images/22.png" alt=" "></p>
<h3 id="點-open-打開設定好欄位條件，可以更快查詢"><a href="#點-open-打開設定好欄位條件，可以更快查詢" class="headerlink" title="點 open 打開設定好欄位條件，可以更快查詢"></a>點 open 打開設定好欄位條件，可以更快查詢</h3><p><img src="images/23.png" alt=" "></p>
<h3 id="New-重新回到沒有任何條件狀態"><a href="#New-重新回到沒有任何條件狀態" class="headerlink" title="New 重新回到沒有任何條件狀態"></a>New 重新回到沒有任何條件狀態</h3><p><img src="images/24.png" alt=" "></p>
<h3 id="Discover-基本操作結束下一篇-Visualize、Dashboard-操作！"><a href="#Discover-基本操作結束下一篇-Visualize、Dashboard-操作！" class="headerlink" title="Discover 基本操作結束下一篇 Visualize、Dashboard 操作！"></a>Discover 基本操作結束下一篇 Visualize、Dashboard 操作！</h3>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/01/elasticsearch-log刪除/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/unnamed.gif">
      <meta itemprop="name" content="緣分到了，文件自然就做好了！">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/08/01/elasticsearch-log刪除/" class="post-title-link" itemprop="url">elasticsearch-log刪除</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Publicado el</span>

              <time title="Creado por: 2018-08-01 14:22:59" itemprop="dateCreated datePublished" datetime="2018-08-01T14:22:59+08:00">2018-08-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Editado el</span>
                <time title="Modificado por: 2020-04-01 11:30:25" itemprop="dateModified" datetime="2020-04-01T11:30:25+08:00">2020-04-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="elasticsearch-log-刪除"><a href="#elasticsearch-log-刪除" class="headerlink" title="elasticsearch log 刪除"></a>elasticsearch log 刪除</h3><h3 id="手動刪除指令"><a href="#手動刪除指令" class="headerlink" title="手動刪除指令"></a>手動刪除指令</h3><h3 id="要按照你-logstash-conf-設定格式才能刪除，-是全部刪除如下例子-2018-就是-2018-的-log-全刪除"><a href="#要按照你-logstash-conf-設定格式才能刪除，-是全部刪除如下例子-2018-就是-2018-的-log-全刪除" class="headerlink" title="要按照你 logstash.conf 設定格式才能刪除，* 是全部刪除如下例子 2018.* 就是 2018 的 log 全刪除"></a>要按照你 logstash.conf 設定格式才能刪除，* 是全部刪除如下例子 2018.* 就是 2018 的 log 全刪除</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl -XDELETE &apos;http://127.0.0.1:9200/( log格式 )&apos;</span><br><span class="line"></span><br><span class="line">ex：curl -XDELETE &apos;http://127.0.0.1:9200/winlogbeat-6.2.2-2018.01.15&apos;</span><br><span class="line"></span><br><span class="line">ex：curl -XDELETE &apos;http://127.0.0.1:9200/winlogbeat-6.2.2-2018.*&apos;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="自動刪除"><a href="#自動刪除" class="headerlink" title="自動刪除"></a>自動刪除</h3><h3 id="我們將使用-linux-的-shell-script-製作腳本，並用排程來達到自動化刪除-log"><a href="#我們將使用-linux-的-shell-script-製作腳本，並用排程來達到自動化刪除-log" class="headerlink" title="我們將使用 linux 的 shell script 製作腳本，並用排程來達到自動化刪除 log"></a>我們將使用 linux 的 shell script 製作腳本，並用排程來達到自動化刪除 log</h3><h3 id="1-建立腳本"><a href="#1-建立腳本" class="headerlink" title="1. 建立腳本"></a>1. 建立腳本</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi (名字隨意).sh</span><br><span class="line"></span><br><span class="line">ex：vi test.sh</span><br></pre></td></tr></table></figure>
<h3 id="腳本內容"><a href="#腳本內容" class="headerlink" title="腳本內容"></a>腳本內容</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">function delete_indices() &#123;</span><br><span class="line">    comp_date=`date -d &quot;30 day ago&quot; +&quot;%Y-%m-%d&quot;`</span><br><span class="line">    date1=&quot;$1 00:00:00&quot;</span><br><span class="line">    date2=&quot;$comp_date 00:00:00&quot;</span><br><span class="line"></span><br><span class="line">    t1=`date -d &quot;$date1&quot; +%s`</span><br><span class="line">    t2=`date -d &quot;$date2&quot; +%s`</span><br><span class="line"></span><br><span class="line">    if [ $t1 -le $t2 ]; then</span><br><span class="line">        echo &quot;$1時間早於$comp_date，進行索引刪除&quot;</span><br><span class="line">        format_date=`echo $1| sed &apos;s/-/\./g&apos;`</span><br><span class="line">        curl -XDELETE http://localhost:9200/*$format_date</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">curl -XGET http://localhost:9200/_cat/indices | awk -F&quot; &quot; &apos;&#123;print $3&#125;&apos; | awk -F&quot;-&quot; &apos;&#123;print $NF&#125;&apos; | egrep &quot;[0-9]*\.[0-9]*\.[0-9]*&quot; | sort | uniq  | sed &apos;s/\./-/g&apos; | while read LINE</span><br><span class="line">do</span><br><span class="line">    delete_indices $LINE</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h3 id="2-給腳本權限"><a href="#2-給腳本權限" class="headerlink" title="2. 給腳本權限"></a>2. 給腳本權限</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x test.sh</span><br></pre></td></tr></table></figure>
<h3 id="3-啟動測試"><a href="#3-啟動測試" class="headerlink" title="3. 啟動測試"></a>3. 啟動測試</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./test.sh</span><br></pre></td></tr></table></figure>
<h3 id="輸出畫面"><a href="#輸出畫面" class="headerlink" title="輸出畫面"></a>輸出畫面</h3><p><img src="images/1.png" alt=" "></p>
<h3 id="4-設定排程：排程設定好刪除-log-不會有測試的輸出畫面"><a href="#4-設定排程：排程設定好刪除-log-不會有測試的輸出畫面" class="headerlink" title="4. 設定排程：排程設定好刪除 log 不會有測試的輸出畫面"></a>4. 設定排程：排程設定好刪除 log 不會有測試的輸出畫面</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/crontabe</span><br></pre></td></tr></table></figure>
<h3 id="進入裡面設置排程"><a href="#進入裡面設置排程" class="headerlink" title="進入裡面設置排程"></a>進入裡面設置排程</h3><p><img src="images/2.png" alt=" "></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0  12  *  *  *  root   /home/h1025139/test.sh</span><br><span class="line"></span><br><span class="line">分  時  日  月  時  使用者  指令</span><br><span class="line"></span><br><span class="line">分鐘 0-59，小時 0-23，日期 1-31，月份 1-12，周 0-7</span><br><span class="line"></span><br><span class="line">* 代表任何時刻都接受的意思，*/1 是每分鐘一次</span><br></pre></td></tr></table></figure>
<h3 id="恭喜完成刪除-log！"><a href="#恭喜完成刪除-log！" class="headerlink" title="恭喜完成刪除 log！"></a>恭喜完成刪除 log！</h3>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/26/使用docker-compose建立ELK/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/unnamed.gif">
      <meta itemprop="name" content="緣分到了，文件自然就做好了！">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/26/使用docker-compose建立ELK/" class="post-title-link" itemprop="url">使用docker-compose建立ELK</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Publicado el</span>

              <time title="Creado por: 2018-07-26 16:13:08" itemprop="dateCreated datePublished" datetime="2018-07-26T16:13:08+08:00">2018-07-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Editado el</span>
                <time title="Modificado por: 2020-05-06 15:07:15" itemprop="dateModified" datetime="2020-05-06T15:07:15+08:00">2020-05-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="本文章將介紹使用-docker-compose-建立-ELK"><a href="#本文章將介紹使用-docker-compose-建立-ELK" class="headerlink" title="本文章將介紹使用 docker-compose 建立 ELK"></a>本文章將介紹使用 docker-compose 建立 ELK</h3><h4 id="指令安裝-docker-compose"><a href="#指令安裝-docker-compose" class="headerlink" title="指令安裝 docker-compose"></a>指令安裝 docker-compose</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install -y docker-compose</span><br></pre></td></tr></table></figure>
<h4 id="建立-logstash-資料夾並進入"><a href="#建立-logstash-資料夾並進入" class="headerlink" title="建立 logstash 資料夾並進入"></a>建立 logstash 資料夾並進入</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir logstash</span><br><span class="line"></span><br><span class="line">cd logstash</span><br></pre></td></tr></table></figure>
<h4 id="建立資料夾-conf-d-裡面放入-logstash-config-跟-logstash-filter-config"><a href="#建立資料夾-conf-d-裡面放入-logstash-config-跟-logstash-filter-config" class="headerlink" title="建立資料夾 conf.d 裡面放入 logstash config 跟 logstash filter config"></a>建立資料夾 conf.d 裡面放入 logstash config 跟 logstash filter config</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir conf.d</span><br><span class="line"></span><br><span class="line">cd conf.d</span><br><span class="line"></span><br><span class="line">vi logstash.conf</span><br><span class="line"></span><br><span class="line">vi serverlog.conf</span><br></pre></td></tr></table></figure>
<h4 id="logstash-conf"><a href="#logstash-conf" class="headerlink" title="logstash.conf"></a>logstash.conf</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">input &#123;</span><br><span class="line">    redis &#123;</span><br><span class="line">        host =&gt; &quot;redis&quot;</span><br><span class="line">        port =&gt; 6379</span><br><span class="line">        data_type =&gt; &quot;list&quot;</span><br><span class="line">        key =&gt; &quot;vplaylog&quot;</span><br><span class="line">        password =&gt; &quot;QFkXXBZkLD6MgcEL1y8l&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">output &#123;</span><br><span class="line">    elasticsearch &#123;</span><br><span class="line">        hosts =&gt; [&quot;elasticsearch&quot;]</span><br><span class="line">        index =&gt; &quot;%&#123;[@metadata][env]&#125;_%&#123;[type]&#125;-%&#123;+YYYY.MM.dd&#125;&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="serverlog-conf"><a href="#serverlog-conf" class="headerlink" title="serverlog.conf"></a>serverlog.conf</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">filter &#123;</span><br><span class="line">    if [type] == &quot;serverlog&quot; &#123;</span><br><span class="line">        grok &#123;</span><br><span class="line">            match =&gt; [&quot;message&quot;, &quot;%&#123;TIMESTAMP_ISO8601:[@metadata][timestamp]&#125; %&#123;NUMBER:threadid&#125; %&#123;LOGLEVEL:loglevel&#125; %&#123;NOTSPACE:logger&#125; %&#123;GREEDYDATA:message&#125;&quot;]</span><br><span class="line">            overwrite =&gt; [ &quot;message&quot; ]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        date &#123;</span><br><span class="line">            match =&gt; [ &quot;[@metadata][timestamp]&quot;, &quot;YYYY-MM-dd HH:mm:ss.SSS&quot; ]</span><br><span class="line">            timezone =&gt; &quot;UTC&quot;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        mutate &#123;</span><br><span class="line">            convert =&gt; &#123;</span><br><span class="line">                &quot;threadid&quot; =&gt; &quot;integer&quot;</span><br><span class="line">            &#125;</span><br><span class="line">            add_field =&gt; &#123; </span><br><span class="line">                &quot;hostname&quot; =&gt; &quot;%&#123;[beat][hostname]&#125;&quot;</span><br><span class="line">                &quot;servertype&quot; =&gt; &quot;%&#123;[fields][servertype]]&#125;&quot;</span><br><span class="line">                &quot;[@metadata][env]&quot; =&gt; &quot;%&#123;[fields][env]]&#125;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">            remove_field =&gt; [&quot;beat&quot;, &quot;fields&quot;]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="回到上一層建立-Dockerfile"><a href="#回到上一層建立-Dockerfile" class="headerlink" title="回到上一層建立 Dockerfile"></a>回到上一層建立 Dockerfile</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ..</span><br><span class="line"></span><br><span class="line">vi Dockerfile</span><br></pre></td></tr></table></figure>
<h4 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FROM  logstash:5.6.7</span><br><span class="line">COPY conf.d /home/ben.yu/logstash/conf.d</span><br><span class="line">CMD [&quot;-f&quot;, &quot;/home/ben.yu/logstash/conf.d&quot;]</span><br></pre></td></tr></table></figure>
<h4 id="建立-docker-compose-yml"><a href="#建立-docker-compose-yml" class="headerlink" title="建立 docker-compose.yml"></a>建立 docker-compose.yml</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir docker-compose.yml</span><br></pre></td></tr></table></figure>
<h4 id="寫入-docker-compose-內容"><a href="#寫入-docker-compose-內容" class="headerlink" title="寫入 docker-compose 內容"></a>寫入 docker-compose 內容</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi docker-compose.yml</span><br></pre></td></tr></table></figure>
<h4 id="寫入內容"><a href="#寫入內容" class="headerlink" title="寫入內容"></a>寫入內容</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">version: &apos;2&apos;</span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line"></span><br><span class="line">  redis:</span><br><span class="line">    container_name: redis</span><br><span class="line">    image: redis:3.2.4</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;6379:6379&quot;</span><br><span class="line">    volumes:</span><br><span class="line">      - /data/redis:/data</span><br><span class="line">    entrypoint: redis-server --maxmemory &quot;4gb&quot; --appendonly yes --requirepass QFkXXBZkLD6MgcEL1y8l</span><br><span class="line">    restart: always</span><br><span class="line">    networks:</span><br><span class="line">      - docker_elk</span><br><span class="line"></span><br><span class="line">  elasticsearch:</span><br><span class="line">    container_name: elasticsearch</span><br><span class="line">    image: elasticsearch:5.6.7</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;9200:9200&quot;</span><br><span class="line">    restart: always</span><br><span class="line">    volumes:</span><br><span class="line">      - /data/elasticsearch:/usr/share/elasticsearch/data</span><br><span class="line">    environment:</span><br><span class="line">      ES_JAVA_OPTS: &quot;-Xms2g -Xmx2g&quot;</span><br><span class="line">    networks:</span><br><span class="line">      - docker_elk</span><br><span class="line"></span><br><span class="line">  logstash:</span><br><span class="line">    build: logstash/</span><br><span class="line">    container_name: logstash</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;5044:5044&quot;</span><br><span class="line">    environment:</span><br><span class="line">      LS_JAVA_OPTS: &quot;-Xmx2g -Xms2g&quot;</span><br><span class="line">    restart: always</span><br><span class="line">    networks:</span><br><span class="line">      - docker_elk</span><br><span class="line">    depends_on:</span><br><span class="line">      - elasticsearch</span><br><span class="line">      - redis</span><br><span class="line"></span><br><span class="line">  kibana:</span><br><span class="line">    container_name: kibana</span><br><span class="line">    image: kibana:5.6.7</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;80:5601&quot;</span><br><span class="line">    restart: always</span><br><span class="line">    networks:</span><br><span class="line">      - docker_elk</span><br><span class="line">    depends_on:</span><br><span class="line">      - elasticsearch</span><br><span class="line"></span><br><span class="line">networks:</span><br><span class="line">  docker_elk:</span><br><span class="line">    driver: bridge</span><br></pre></td></tr></table></figure>
<h4 id="儲存後下指令-run-docker-compose"><a href="#儲存後下指令-run-docker-compose" class="headerlink" title="儲存後下指令 run docker-compose"></a>儲存後下指令 run docker-compose</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>
<h4 id="到這邊就完成了"><a href="#到這邊就完成了" class="headerlink" title="到這邊就完成了"></a>到這邊就完成了</h4>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/26/使用filebeat把log丟進elk/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/unnamed.gif">
      <meta itemprop="name" content="緣分到了，文件自然就做好了！">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/26/使用filebeat把log丟進elk/" class="post-title-link" itemprop="url">使用filebeat把log丟進elk</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Publicado el</span>

              <time title="Creado por: 2018-07-26 16:13:07" itemprop="dateCreated datePublished" datetime="2018-07-26T16:13:07+08:00">2018-07-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Editado el</span>
                <time title="Modificado por: 2020-04-28 10:18:33" itemprop="dateModified" datetime="2020-04-28T10:18:33+08:00">2020-04-28</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="本章將介紹使用-filebeat-將-log-丟進-elk"><a href="#本章將介紹使用-filebeat-將-log-丟進-elk" class="headerlink" title="本章將介紹使用 filebeat 將 log 丟進 elk"></a>本章將介紹使用 filebeat 將 log 丟進 elk</h3><h4 id="filebeat-下載：https-www-elastic-co-downloads-beats-filebeat"><a href="#filebeat-下載：https-www-elastic-co-downloads-beats-filebeat" class="headerlink" title="filebeat 下載：https://www.elastic.co/downloads/beats/filebeat"></a>filebeat 下載：<a href="https://www.elastic.co/downloads/beats/filebeat" target="_blank" rel="noopener">https://www.elastic.co/downloads/beats/filebeat</a></h4><h4 id="PS：filebeat-盡量跟-elk-同版本"><a href="#PS：filebeat-盡量跟-elk-同版本" class="headerlink" title="PS：filebeat 盡量跟 elk 同版本"></a>PS：filebeat 盡量跟 elk 同版本</h4><h4 id="解壓縮-filebeat-到你要的路徑下"><a href="#解壓縮-filebeat-到你要的路徑下" class="headerlink" title="解壓縮 filebeat 到你要的路徑下"></a>解壓縮 filebeat 到你要的路徑下</h4><p><img src="images/1.png" alt=" "></p>
<h4 id="開啟-filebeat-資料夾底下的-filebeat-yml-檔，可以看到蒐集器的設定，路徑以自己本機-log-放置位置為主"><a href="#開啟-filebeat-資料夾底下的-filebeat-yml-檔，可以看到蒐集器的設定，路徑以自己本機-log-放置位置為主" class="headerlink" title="開啟 filebeat 資料夾底下的 filebeat.yml 檔，可以看到蒐集器的設定，路徑以自己本機 log 放置位置為主"></a>開啟 filebeat 資料夾底下的 filebeat.yml 檔，可以看到蒐集器的設定，路徑以自己本機 log 放置位置為主</h4><p><img src="images/2.png" alt=" "><br><img src="images/3.png" alt=" "></p>
<h4 id="第183行的-env-的值，請修改為屆時要在-Kibana-Fields-的名稱"><a href="#第183行的-env-的值，請修改為屆時要在-Kibana-Fields-的名稱" class="headerlink" title="第183行的 env 的值，請修改為屆時要在 Kibana Fields 的名稱"></a>第183行的 env 的值，請修改為屆時要在 Kibana Fields 的名稱</h4><h4 id="第198行請輸入-ELK-機器的內網-IP"><a href="#第198行請輸入-ELK-機器的內網-IP" class="headerlink" title="第198行請輸入 ELK 機器的內網 IP"></a>第198行請輸入 ELK 機器的內網 IP</h4><h4 id="第206行的-key-值，請輸入相同於-Logstash-conf-內-input-底下-key-值"><a href="#第206行的-key-值，請輸入相同於-Logstash-conf-內-input-底下-key-值" class="headerlink" title="第206行的 key 值，請輸入相同於 Logstash.conf 內 input 底下 key 值"></a>第206行的 key 值，請輸入相同於 Logstash.conf 內 input 底下 key 值</h4><h4 id="第357行的-password-值，請輸入相同於-Logstash-conf-內-input-底下的-password-值"><a href="#第357行的-password-值，請輸入相同於-Logstash-conf-內-input-底下的-password-值" class="headerlink" title="第357行的 password 值，請輸入相同於 Logstash.conf 內 input 底下的 password 值"></a>第357行的 password 值，請輸入相同於 Logstash.conf 內 input 底下的 password 值</h4><p><img src="images/4.png" alt=" "></p>
<h4 id="以系統管理員開啟-Windows-Power-Shell，輸入指令執行安裝-filebeat-服務，並啟動服務"><a href="#以系統管理員開啟-Windows-Power-Shell，輸入指令執行安裝-filebeat-服務，並啟動服務" class="headerlink" title="以系統管理員開啟 Windows Power Shell，輸入指令執行安裝 filebeat 服務，並啟動服務"></a>以系統管理員開啟 Windows Power Shell，輸入指令執行安裝 filebeat 服務，並啟動服務</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">d:</span><br><span class="line"></span><br><span class="line">cd .\service\filebeat-5.6.7-windows-x86_64 ( 檔案路徑 )  </span><br><span class="line"></span><br><span class="line">.\install-service-filebeat.ps1</span><br><span class="line"></span><br><span class="line">net start filebeat</span><br></pre></td></tr></table></figure>
<p><img src="images/5.png" alt=" "></p>
<h4 id="到-windows-服務去檢查是否啟動"><a href="#到-windows-服務去檢查是否啟動" class="headerlink" title="到 windows 服務去檢查是否啟動"></a>到 windows 服務去檢查是否啟動</h4><p><img src="images/6.png" alt=" "><br><img src="images/7.png" alt=" "></p>
<h4 id="回到-ELK-下指令可以看到-index"><a href="#回到-ELK-下指令可以看到-index" class="headerlink" title="回到 ELK 下指令可以看到 index"></a>回到 ELK 下指令可以看到 index</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET http://127.0.0.1:9200/_cat/indices?v</span><br></pre></td></tr></table></figure>
<p><img src="images/8.png" alt=" "></p>
<h4 id="開啟-web-輸入-elk-機器外網-IP-進入-elk"><a href="#開啟-web-輸入-elk-機器外網-IP-進入-elk" class="headerlink" title="開啟 web 輸入 elk 機器外網 IP 進入 elk"></a>開啟 web 輸入 elk 機器外網 IP 進入 elk</h4><h4 id="進入-kibana-畫面"><a href="#進入-kibana-畫面" class="headerlink" title="進入 kibana 畫面"></a>進入 kibana 畫面</h4><p><img src="images/9.png" alt=" "></p>
<h4 id="輸入剛剛在-elk-看到的-index"><a href="#輸入剛剛在-elk-看到的-index" class="headerlink" title="輸入剛剛在 elk 看到的 index"></a>輸入剛剛在 elk 看到的 index</h4><p><img src="images/10.png" alt=" "></p>
<h4 id="點擊左邊-discover-就可以看到匯入的-log-了"><a href="#點擊左邊-discover-就可以看到匯入的-log-了" class="headerlink" title="點擊左邊 discover 就可以看到匯入的 log 了"></a>點擊左邊 discover 就可以看到匯入的 log 了</h4><p><img src="images/11.png" alt=" "></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/26/ELK建立/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/unnamed.gif">
      <meta itemprop="name" content="緣分到了，文件自然就做好了！">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系筆記">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/26/ELK建立/" class="post-title-link" itemprop="url">ELK建立</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Publicado el</span>

              <time title="Creado por: 2018-07-26 16:13:06" itemprop="dateCreated datePublished" datetime="2018-07-26T16:13:06+08:00">2018-07-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Editado el</span>
                <time title="Modificado por: 2020-06-09 15:48:25" itemprop="dateModified" datetime="2020-06-09T15:48:25+08:00">2020-06-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="本文章將介紹如何用-docker-建立-ELK"><a href="#本文章將介紹如何用-docker-建立-ELK" class="headerlink" title="本文章將介紹如何用 docker 建立 ELK"></a>本文章將介紹如何用 docker 建立 ELK</h3><h4 id="新環境更新"><a href="#新環境更新" class="headerlink" title="新環境更新"></a>新環境更新</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
<h4 id="下載-docker"><a href="#下載-docker" class="headerlink" title="下載 docker"></a>下載 docker</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y docker.io</span><br></pre></td></tr></table></figure>
<h4 id="下載-redis-image-並且-docker-run-起來"><a href="#下載-redis-image-並且-docker-run-起來" class="headerlink" title="下載 redis image 並且 docker run 起來"></a>下載 redis image 並且 docker run 起來</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name redis -p 6379:6379 -v /data/redis:/data --restart=always redis:3.2.4 redis-server --appendonly yes --maxmemory 4gb --requirepass QFkXXBZkLD6MgcEL1y8l</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">指令</th>
<th></th>
<th style="text-align:left">意義</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-d</td>
<td></td>
<td style="text-align:left">在背景執行</td>
</tr>
<tr>
<td style="text-align:left">–name</td>
<td></td>
<td style="text-align:left">Container的名稱</td>
</tr>
<tr>
<td style="text-align:left">-p</td>
<td></td>
<td style="text-align:left">本機與Container對應的port</td>
</tr>
<tr>
<td style="text-align:left">-v</td>
<td></td>
<td style="text-align:left">本機與Container對應的資料路徑</td>
</tr>
<tr>
<td style="text-align:left">–restart=always</td>
<td></td>
<td style="text-align:left">機器重啟後Container自動重啟（預設是關閉）</td>
</tr>
<tr>
<td style="text-align:left">redis:3.2.4</td>
<td></td>
<td style="text-align:left">Redis Container的映像檔名稱與版本</td>
</tr>
<tr>
<td style="text-align:left">redis-server</td>
<td></td>
<td style="text-align:left">建立redis的server（另有redis-cli的客端版本）</td>
</tr>
<tr>
<td style="text-align:left">–appendonly yes</td>
<td></td>
<td style="text-align:left">是否做資料持久化</td>
</tr>
<tr>
<td style="text-align:left">–maxmemory 4gb</td>
<td></td>
<td style="text-align:left">設定Redis Container 占用記憶體的最大容量</td>
</tr>
<tr>
<td style="text-align:left">–requirepass</td>
<td></td>
<td style="text-align:left">客端VM 將Log 資料傳送到Redis 時驗證用的key</td>
</tr>
</tbody>
</table>
<h4 id="輸入以下指令增加虛擬記憶體大小（至少要大於262144-KB，否則建立好的Elasticsearch執行會失敗）"><a href="#輸入以下指令增加虛擬記憶體大小（至少要大於262144-KB，否則建立好的Elasticsearch執行會失敗）" class="headerlink" title="輸入以下指令增加虛擬記憶體大小（至少要大於262144 KB，否則建立好的Elasticsearch執行會失敗）"></a>輸入以下指令增加虛擬記憶體大小（至少要大於262144 KB，否則建立好的Elasticsearch執行會失敗）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo vm.max_map_count=262144 &gt;&gt; /etc/sysctl.conf</span><br></pre></td></tr></table></figure>
<h4 id="下載-elasticsearch-image-並且-docker-run-起來"><a href="#下載-elasticsearch-image-並且-docker-run-起來" class="headerlink" title="下載 elasticsearch image 並且 docker run 起來"></a>下載 elasticsearch image 並且 docker run 起來</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name es -p 9200:9200 --restart=always -v /data/elasticsearch:/usr/share/elasticsearch/data -e ES_JAVA_OPTS:-Xmx6g -e ES_JAVA_OPTS:-Xms6g elasticsearch:5.6.7</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">指令</th>
<th>意義</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-d</td>
<td>在背景執行</td>
</tr>
<tr>
<td style="text-align:left">–name</td>
<td>Container 名稱</td>
</tr>
<tr>
<td style="text-align:left">-p</td>
<td>本機與 Container 對應的 port</td>
</tr>
<tr>
<td style="text-align:left">-v</td>
<td>本機與 Container 對應的資料路徑</td>
</tr>
<tr>
<td style="text-align:left">–restart=always</td>
<td>機器重啟後Container自動重啟（預設是關閉）</td>
</tr>
<tr>
<td style="text-align:left">-e ES_JAVA_OPTS:-Xms</td>
<td>指定Elasticsearch 占用記憶體的初始值</td>
</tr>
<tr>
<td style="text-align:left">-e ES_JAVA_OPTS:-Xmx</td>
<td>指定Elasticsearch 占用記憶體的最大值</td>
</tr>
<tr>
<td style="text-align:left">elasticsearch:5.6.7</td>
<td>Elasticsearch 的映像檔名稱與版本</td>
</tr>
</tbody>
</table>
<h4 id="建立資料夾-conf-d-裡面放入-logstash-config-跟-logstash-filter-config"><a href="#建立資料夾-conf-d-裡面放入-logstash-config-跟-logstash-filter-config" class="headerlink" title="建立資料夾 conf.d 裡面放入 logstash config 跟 logstash filter config"></a>建立資料夾 conf.d 裡面放入 logstash config 跟 logstash filter config</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir conf.d</span><br><span class="line"></span><br><span class="line">cd conf.d</span><br><span class="line"></span><br><span class="line">vi logstash.conf</span><br><span class="line"></span><br><span class="line">vi serverlog.conf</span><br></pre></td></tr></table></figure>
<h4 id="logstash-conf"><a href="#logstash-conf" class="headerlink" title="logstash.conf"></a>logstash.conf</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">input &#123;</span><br><span class="line">    redis &#123;</span><br><span class="line">        host =&gt; &quot;redis&quot;</span><br><span class="line">        port =&gt; 6379</span><br><span class="line">        data_type =&gt; &quot;list&quot;</span><br><span class="line">        key =&gt; &quot;vplaylog&quot;</span><br><span class="line">        password =&gt; &quot;QFkXXBZkLD6MgcEL1y8l&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">output &#123;</span><br><span class="line">    elasticsearch &#123;</span><br><span class="line">        hosts =&gt; [&quot;elasticsearch&quot;]</span><br><span class="line">        index =&gt; &quot;%&#123;[@metadata][env]&#125;_%&#123;[type]&#125;-%&#123;+YYYY.MM.dd&#125;&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="serverlog-conf"><a href="#serverlog-conf" class="headerlink" title="serverlog.conf"></a>serverlog.conf</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">filter &#123;</span><br><span class="line">    if [type] == &quot;serverlog&quot; &#123;</span><br><span class="line">        grok &#123;</span><br><span class="line">            match =&gt; [&quot;message&quot;, &quot;%&#123;TIMESTAMP_ISO8601:[@metadata][timestamp]&#125; %&#123;NUMBER:threadid&#125; %&#123;LOGLEVEL:loglevel&#125; %&#123;NOTSPACE:logger&#125; %&#123;GREEDYDATA:message&#125;&quot;]</span><br><span class="line">            overwrite =&gt; [ &quot;message&quot; ]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        date &#123;</span><br><span class="line">            match =&gt; [ &quot;[@metadata][timestamp]&quot;, &quot;YYYY-MM-dd HH:mm:ss.SSS&quot; ]</span><br><span class="line">            timezone =&gt; &quot;UTC&quot;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        mutate &#123;</span><br><span class="line">            convert =&gt; &#123;</span><br><span class="line">                &quot;threadid&quot; =&gt; &quot;integer&quot;</span><br><span class="line">            &#125;</span><br><span class="line">            add_field =&gt; &#123; </span><br><span class="line">                &quot;hostname&quot; =&gt; &quot;%&#123;[beat][hostname]&#125;&quot;</span><br><span class="line">                &quot;servertype&quot; =&gt; &quot;%&#123;[fields][servertype]]&#125;&quot;</span><br><span class="line">                &quot;[@metadata][env]&quot; =&gt; &quot;%&#123;[fields][env]]&#125;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">            remove_field =&gt; [&quot;beat&quot;, &quot;fields&quot;]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="回到上一層建立-Dockerfile"><a href="#回到上一層建立-Dockerfile" class="headerlink" title="回到上一層建立 Dockerfile"></a>回到上一層建立 Dockerfile</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ..</span><br><span class="line"></span><br><span class="line">vi Dockerfile</span><br></pre></td></tr></table></figure>
<h4 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FROM  logstash:5.6.7</span><br><span class="line">COPY conf.d /etc/logstash/conf.d</span><br><span class="line">CMD [&quot;-f&quot;, &quot;/etc/logstash/conf.d&quot;]</span><br></pre></td></tr></table></figure>
<p><img src="images/1.png" alt=" "><br><img src="images/2.png" alt=" "></p>
<h4 id="buile-logstash-imsgea-t-test-是幫容器命名"><a href="#buile-logstash-imsgea-t-test-是幫容器命名" class="headerlink" title="buile logstash imsgea ( -t test 是幫容器命名 )"></a>buile logstash imsgea ( -t test 是幫容器命名 )</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t test .</span><br></pre></td></tr></table></figure>
<h4 id="把-logstash-docker-run-起來"><a href="#把-logstash-docker-run-起來" class="headerlink" title="把 logstash docker run 起來"></a>把 logstash docker run 起來</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name logstash -p 5044:5044 --link es:elasticsearch --link redis:redis --restart=always -e LS_JAVA_OPTS:-Xms6g -e LS_JAVA_OPTS:-Xmx6g test</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">指令</th>
<th>意義</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-d</td>
<td>在背景執行</td>
</tr>
<tr>
<td style="text-align:left">–name</td>
<td>Container 名稱</td>
</tr>
<tr>
<td style="text-align:left">-p</td>
<td>本機與 Container 對應的 port</td>
</tr>
<tr>
<td style="text-align:left">-v</td>
<td>本機與 Container 對應的資料路徑</td>
</tr>
<tr>
<td style="text-align:left">–link</td>
<td>與其它的 Container 做連結</td>
</tr>
<tr>
<td style="text-align:left">–restart=always</td>
<td>機器重啟後 Container自動重啟（預設是關閉）</td>
</tr>
<tr>
<td style="text-align:left">-e ES_JAVA_OPTS:-Xms</td>
<td>指定 logstash 占用記憶體的初始值</td>
</tr>
<tr>
<td style="text-align:left">-e ES_JAVA_OPTS:-Xmx</td>
<td>指定 logstash 占用記憶體的最大值</td>
</tr>
<tr>
<td style="text-align:left">test</td>
<td>logstash build 起來的映像檔名稱</td>
</tr>
</tbody>
</table>
<h4 id="下載-kibana-image-並且-docker-run-起來"><a href="#下載-kibana-image-並且-docker-run-起來" class="headerlink" title="下載 kibana image 並且 docker run 起來"></a>下載 kibana image 並且 docker run 起來</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name kibana --restart=always -p 80:5601 --link es:elasticsearch kibana:5.6.7</span><br></pre></td></tr></table></figure>
<h4 id="查看容器是否建立成功"><a href="#查看容器是否建立成功" class="headerlink" title="查看容器是否建立成功"></a>查看容器是否建立成功</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure>
<p><img src="images/3.png" alt=" "></p>
<h4 id="道邊-ELK-設置就成功了，下一章將介紹把-LOG-丟進-ELK"><a href="#道邊-ELK-設置就成功了，下一章將介紹把-LOG-丟進-ELK" class="headerlink" title="道邊 ELK 設置就成功了，下一章將介紹把 LOG 丟進 ELK"></a>道邊 ELK 設置就成功了，下一章將介紹把 LOG 丟進 ELK</h4>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="Página anterior"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="Página siguiente"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Tabla de contenidos
        </li>
        <li class="sidebar-nav-overview">
          Inicio
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="緣分到了，文件自然就做好了！"
      src="/images/unnamed.gif">
  <p class="site-author-name" itemprop="name">緣分到了，文件自然就做好了！</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">72</span>
          <span class="site-state-item-name">entradas</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">緣分到了，文件自然就做好了！</span>
</div>
  <div class="powered-by">Creado mediante <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  















  

  

</body>
</html>
